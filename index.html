<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>100-Level Diverse Boss Platformer</title>
  <style>
    body { margin:0; background:#111; }
    canvas { display:block; }
    .hud { position:fixed; inset:0; pointer-events:none; }
    .stick-area, .btn { pointer-events:auto; touch-action:none; }
    .stick-area {
      position:fixed; bottom:16px; left:16px; width:120px; height:120px;
      border-radius:50%; background:rgba(255,255,255,0.08);
    }
    .stick-knob {
      position:absolute; left:50%; top:50%; width:40px; height:40px;
      border-radius:50%; background:#0af; transform:translate(-50%,-50%);
    }
    .btn {
      position:fixed; right:16px; bottom:16px; width:80px; height:80px;
      border-radius:50%; background:#fff; display:flex; align-items:center; justify-content:center;
      font-weight:bold;
    }
    .label {
      position:fixed; top:8px; left:50%; transform:translateX(-50%);
      color:#fff; font-family:sans-serif; font-size:18px; background:rgba(0,0,0,0.4);
      padding:6px 10px; border-radius:8px;
    }
    #skipBtn {
      position:fixed; top:60px; right:20px;
      background:#fff; border:none; padding:8px 12px; border-radius:6px;
      font-weight:bold; display:none;
    }
  </style>
</head>
<body>
<canvas id="game"></canvas>
<div class="hud">
  <div class="label" id="levelLabel">Level 1 | Coins: 0</div>
  <div id="moveStick" class="stick-area"><div id="moveKnob" class="stick-knob"></div></div>
  <div id="jumpBtn" class="btn">Jump</div>
</div>
<button id="skipBtn">Skip Boss</button>

<script>
const canvas=document.getElementById("game"),ctx=canvas.getContext("2d");
canvas.width=window.innerWidth;canvas.height=window.innerHeight;

const TILE=32,W=32,H=16;
let coinTotal=0,playerColor="#ffd166";
const player={x:0,y:0,w:24,h:28,vx:0,vy:0,onGround:false,jumps:0};

const levels=[];

// Themes
function grasslands(i){return {theme:"Grasslands",hazards:[{x:5,y:14}],coins:[{x:200,y:400}],enemies:[{type:"patrol",x:300,y:450,w:24,h:28,dir:1,minX:280,maxX:600,speed:60}]};}
function caves(i){return {theme:"Caves",dark:true,hazards:[{x:10,y:14}],coins:[{x:400,y:300}],enemies:[{type:"fly",x:480,y:360,w:22,h:22,t:0,ampX:40,ampY:25,baseX:480,baseY:360,speed:2}]};}
function sky(i){return {theme:"Sky",platforms:[{x:16*TILE,y:11*TILE,w:TILE,h:TILE,vx:0,vy:-40,minY:9*TILE,maxY:12*TILE}],coins:[{x:600,y:220}],enemies:[]};}
function lava(i){return {theme:"Lava",hazards:[{x:6,y:14},{x:7,y:14},{x:8,y:14}],coins:[{x:260,y:340}],enemies:[{type:"chase",x:520,y:450,w:24,h:28,speed:85,range:240}]};}
function ice(i){return {theme:"Ice",slippery:true,coins:[{x:300,y:350}],enemies:[{type:"patrol",x:400,y:450,w:24,h:28,dir:1,minX:380,maxX:600,speed:70}]};}
function factory(i){return {theme:"Factory",conveyor:true,coins:[{x:420,y:320}],enemies:[{type:"turret",x:500,y:400,w:20,h:20,fire:0}]};}
function haunted(i){return {theme:"Haunted",coins:[{x:380,y:350}],enemies:[{type:"ghost",x:440,y:450,w:24,h:28,t:0}]};}
function jungle(i){return {theme:"Jungle",coins:[{x:320,y:300}],platforms:[{x:200,y:10*TILE,w:TILE,h:TILE,vx:50,vy:0,minX:180,maxX:220}],enemies:[]};}
function space(i){return {theme:"Space",lowGravity:true,coins:[{x:500,y:280}],enemies:[{type:"fly",x:480,y:360,w:22,h:22,t:0,ampX:60,ampY:40,baseX:480,baseY:360,speed:1}]};}

// Boss generator
function bossLevel(i){
  return {boss:true,enemies:[{type:"boss",x:400,y:400,w:60,h:60,hp:5}]};
}

// Generate 100 levels
for(let i=1;i<=100;i++){
  const boss=(i%10===0);
  let themeData;
  if(boss){themeData=bossLevel(i);}
  else if(i<=10)themeData=grasslands(i);
  else if(i<=20)themeData=caves(i);
  else if(i<=30)themeData=sky(i);
  else if(i<=40)themeData=lava(i);
  else if(i<=50)themeData=ice(i);
  else if(i<=60)themeData=factory(i);
  else if(i<=70)themeData=haunted(i);
  else if(i<=80)themeData=jungle(i);
  else if(i<=90)themeData=space(i);
  else themeData={theme:"Boss Rush",boss:true,enemies:[{type:"boss",x:400,y:400,w:60,h:60,hp:10}]};

  const tiles=Array.from({length:H},(_,y)=>Array(W).fill(0));
  tiles[15].fill(1);
  if(!boss) tiles[15][30]=4;

  levels.push({name:"Level "+i+(boss?" (Boss)":""),
               tiles,start:{x:TILE*2,y:(15*TILE)-28},
               coins:themeData.coins||[],enemies:themeData.enemies||[],
               platforms:themeData.platforms||[],hazards:themeData.hazards||[],
               boss,theme:themeData.theme||"",dark:themeData.dark||false,
               slippery:themeData.slippery||false,conveyor:themeData.conveyor||false,
               lowGravity:themeData.lowGravity||false});
}

let levelIndex=0;
function loadLevel(i){
  levelIndex=i%levels.length;
  document.getElementById("levelLabel").textContent=levels[levelIndex].name+" | Coins: "+coinTotal;
  player.x=levels[levelIndex].start.x;player.y=levels[levelIndex].start.y;
  player.vx=player.vy=0;player.jumps=0;
  document.getElementById("skipBtn").style.display=levels[levelIndex].boss?"block":"none";
}
loadLevel(0);

// Skip button
document.getElementById("skipBtn").onclick=()=>{loadLevel(levelIndex+1);};

// Input
const keys={};
window.addEventListener("keydown",e=>keys[e.code]=true);
window.addEventListener("keyup",e=>keys[e.code]=false);

// Touch joystick
let moveVec={x:0};
(function setupStick(){
  const area=document.getElementById('moveStick'),knob=document.getElementById('moveKnob');
  let active=false,startX=0;
  area.addEventListener('touchstart',e=>{active=true;startX=e.touches[0].clientX;});
  area.addEventListener('touchmove',e=>{
    if(!active)return;
    const dx=e.touches[0].clientX-startX;
    const radius=area.clientWidth/2-20;
    const nx=Math.max(-radius,Math.min(radius,dx));
    knob.style.left=`calc(50% + ${nx}px)`;moveVec.x=nx/radius;
  });
  area.addEventListener('touchend',()=>{active=false;moveVec.x=0;knob.style.left='50%';});
})();

// Double jump
function tryJump(){if(player.jumps<2){player.vy=-500;player.onGround=false;player.jumps++;}}
document.get
