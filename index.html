<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>2D Platformer</title>
  <style>
    body { margin:0; background:#111; }
    canvas { display:block; }
  </style>
</head>
<body>
<canvas id="game"></canvas>
<script>
const canvas=document.getElementById("game"),ctx=canvas.getContext("2d");
canvas.width=window.innerWidth;canvas.height=window.innerHeight;

const TILE=32;
const levels=[
  {
    name:"Level 1",
    width:32,height:16,
    tiles:Array.from({length:16},(_,y)=>{
      const row=Array(32).fill(0);
      if(y===15){row.fill(1);row[30]=4;} // ground + goal
      return row;
    }),
    start:{x:64,y:64}
  },
  {
    name:"Level 2",
    width:32,height:16,
    tiles:Array.from({length:16},(_,y)=>{
      const row=Array(32).fill(0);
      if(y===15){row.fill(1);row[28]=4;} // ground + goal
      if(y===13){row[10]=1;row[14]=1;row[18]=1;row[22]=1;} // stepping stones
      return row;
    }),
    start:{x:64,y:64}
  }
];
let levelIndex=0;

const player={x:0,y:0,w:24,h:28,vx:0,vy:0,onGround:false};
function loadLevel(i){
  levelIndex=i%levels.length;
  player.x=levels[levelIndex].start.x;
  player.y=levels[levelIndex].start.y;
  player.vx=player.vy=0;
}
loadLevel(0);

function tileAt(px,py){
  const L=levels[levelIndex];
  const tx=Math.floor(px/TILE),ty=Math.floor(py/TILE);
  if(tx<0||ty<0||tx>=L.width||ty>=L.height)return 0;
  return L.tiles[ty][tx];
}

const keys={};
window.addEventListener("keydown",e=>keys[e.code]=true);
window.addEventListener("keyup",e=>keys[e.code]=false);

function update(dt){
  // input
  if(keys["ArrowLeft"]) player.vx=-200;
  else if(keys["ArrowRight"]) player.vx=200;
  else player.vx=0;
  if(keys["Space"]&&player.onGround){player.vy=-500;player.onGround=false;}

  // physics
  player.vy+=1000*dt;
  player.x+=player.vx*dt;
  player.y+=player.vy*dt;

  // collision
  const t=tileAt(player.x+player.w/2,player.y+player.h);
  if(t===1||t===4){
    player.y=Math.floor((player.y+player.h)/TILE)*TILE-player.h;
    player.vy=0;player.onGround=true;
    if(t===4){alert("Level complete!");loadLevel(levelIndex+1);}
  }
}

function draw(){
  ctx.fillStyle="#222";ctx.fillRect(0,0,canvas.width,canvas.height);
  const L=levels[levelIndex];
  for(let y=0;y<L.height;y++){
    for(let x=0;x<L.width;x++){
      const t=L.tiles[y][x];if(!t)continue;
      const px=x*TILE,py=y*TILE;
      if(t===1){ctx.fillStyle="#555";ctx.fillRect(px,py,TILE,TILE);}
      if(t===4){ctx.fillStyle="#1e88e5";ctx.fillRect(px,py,TILE,TILE);}
    }
  }
  ctx.fillStyle="#ffd166";ctx.fillRect(player.x,player.y,player.w,player.h);
}

let last=performance.now();
function loop(now){
  const dt=(now-last)/1000;last=now;
  update(dt);
  draw();
  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);
</script>
</body>
</html>
